---
title: "Midterm Review"
subtitle: "EC 380: International Economic Issues"
author: "Philip Economides"
date: "Fall 2022"
output:
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    # self_contained: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
class: inverse, middle

```{r Setup, include = F}
options(htmltools.dir.version = FALSE)
library(pacman)
p_load(ggthemes, viridis, knitr, extrafont, tidyverse, magrittr, wooldridge, stargazer, latex2exp, parallel, broom, wooldridge, readxl, jtools, huxtable, data.table)
# Define colors
red_pink <- "#e64173"
met_slate <- "#23373b" # metropolis font color
# Knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  #dpi = 300,
  #cache = T,
  warning = F,
  message = F
)  
theme_simple <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 14),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank(),
  plot.title = element_blank(),
  legend.position = "none"
)
theme_empty <- theme_bw() + theme(
  line = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  axis.text = element_blank(),
  plot.title = element_blank(),
  axis.title = element_blank(),
  plot.margin = structure(c(0, 0, -1, -1), unit = "lines", valid.unit = 3L, class = "unit"),
  legend.position = "none"
)

```

# Prologue

---

# Current Performance

```{r, echo=FALSE, out.width="90%"}
#getwd()
scores <- fread("midterm_grades.csv")
post_mid <- scores %>% mutate(`Current Score` = as.numeric(`Current Score`)) %>%
  filter(`Current Score` >0 ) %>% arrange(desc(`Current Score`)) 


ggplot(post_mid) + ggtitle("Scores Distribution") +
  geom_density(aes(x=`Current Score`), fill="blue", alpha=0.3) +
  scale_x_continuous(expand=c(0,0), limits=c(0,100))+
  xlab("Current %")+
  theme_pander()
  

```


---

# Current Performance

```{r, echo=FALSE, message=FALSE, out.width="90%"}

midterm_comp = fread("midterm_view_comp.csv")

videos = sort(unique(midterm_comp$`Session Name`))
students = sort(unique(midterm_comp$Name))
df_comp  = list()
count = 1

for(v in 1:length(videos)){
  for(s in 1:length(students)){
    
    df_comp[[count]] = tibble(`Session Name` = videos[v],
                              Name = students[s])
    count = count + 1
    
  }
}

df_comp = rbindlist(df_comp)

df_comp = left_join(df_comp, midterm_comp %>% 
            select(`Session Name`, Name, `Minutes Delivered`, `Percent Completed`) ) %>%
            mutate(`Minutes Delivered` = ifelse(is.na(`Minutes Delivered`)==1, 0, `Minutes Delivered`),
                   `Percent Completed` = ifelse(is.na(`Percent Completed`)==1, 0, `Percent Completed`))

df_comp = df_comp %>% group_by(Name) %>% 
  summarise(perc_comp = weighted.mean(`Percent Completed`, `Minutes Delivered`, na.rm=TRUE)) %>% 
  arrange(desc(perc_comp))

df_comp$Name = gsub(" , ", ", ", with(df_comp, paste(word(Name, 2), ",", word(Name, 1)), sep=" "))

df_comp = df_comp %>% mutate(Name = ifelse(Name=="Robinson, Kennedy", "Robinson Sass, Kennedy", Name)) %>% 
  filter(Name !="Economides, Philip")

#setdiff(df_comp$Name, post_mid$Student)
#setdiff(post_mid$Student, df_comp$Name)

ggplot(df_comp) + ggtitle("Panopto Completion Distribution") +
  geom_density(aes(x=perc_comp), fill="green", alpha=0.3) +
  scale_x_continuous(expand=c(0,0), limits=c(0,100))+
  xlab("%")+
  theme_pander()

```


---

# Current Performance

```{r, echo=FALSE, message=FALSE}

`%ni%` <- Negate(`%in%`)

join_perf = left_join(post_mid %>% select(Student, `Current Score`), df_comp %>% rename(Student = Name)) %>%
  mutate(perc_comp = ifelse(is.na(perc_comp)==1, 0, perc_comp)) %>%
  # Filter out those who havent taken midterm yet
  filter(Student %ni% c("Williamson, Justin", "Wang, Shirley", "Park, Ashleigh"))

#cor(join_perf$`Current Score`, join_perf$perc_comp)


ggplot(join_perf, aes(x=perc_comp,y=`Current Score`)) +
  geom_point() +
  geom_smooth(method="lm") +
  ylab("Current Score, Canvas") + xlab("% of Videos Completed, Panopto") +
  scale_y_continuous(expand=c(0,0), limits=c(0, 110)) +
  ggtitle("Co-movement of these variables") +
  theme_pander()
  
```


---

# Current Performance

```{r, echo=FALSE, out.width="20%"}

res <- lm(data=join_perf, `Current Score` ~ perc_comp)


#export_summs(res, model.names = "Dep: Score")
#stargazer(res, type="html")

```

Involvement appears to be .hi-pink[highly predictive] of .hi-pink[performance].

* Every additional one percentage point increase in .hi-pink[Panopto completions] was associated with, on average, a 0.34 percentage point increase in .hi-pink[current score]. 

---

exclude: true

```{R generate pdfs, include = F, eval = F}
#remotes::install_github('rstudio/pagedown')
library(pagedown)
pagedown::chrome_print("Midterm-Review.html", output = "Midterm-Review.pdf")
```